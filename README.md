# Mondo Changelog Template

Template and rake task for generating a changelog with data from the local git repository and PivotalTracker stories.

## Overview

There are two main components in this repository:

1. The changelog template is powered by [middleman](http://middlemanapp.com).
2. The rake task that parses the local git repository and queries the PivotalTracker for release information, then generates and writes the HTML changelog document.

## Install

Install gems

```shell
bundle
```

Install Bower Packages

```shell
bower install
```

## Use

### To generate a changelog for your project

Build the template

```shell
middleman build
```

This will generate the minified and concatenated template into the `build/` directory.

Create a `changelog` folder in within your project, then copy the template you just built into it:

```shell
cd my_project
mkdir changelog
cp -R ../mondo-changelog/build/* changelog
```

Copy the rake task into your project:

In a Rails app:
```shell
cp ../mondo-changelog/lib/tasks/changelog.rake lib/tasks
```

In a Backbone app:
```shell
cp ../mondo-changelog/lib/tasks/changelog.rake build/tasks
```

If your `Rakefile` isn't configured to load tasks from a subfolder, add the following to your `Rakefile`:
```ruby
Dir.glob('lib/tasks/*.rake').each {|task| load task}
```
Add your PivotalTracker API Token as an environment variable.

* Find your PivotalTracker API Token in your Pivotal account profile.
* Copy it, then add it to your `.bash_profile` or wherever you like to set environment variables:
  ```.bash_profile
  export PIVOTAL_API_KEY=xxx
  ```

Now we're ready to generate the changelog:
```shell
rake changelog:generate
```

This will take a while as the task looks through the tags and commits in your repository, then queries the PivotalTracker API for each user story it finds within the commit messages.

When the script is complete you should have a nicely styled changelog at `changelog/index.html`

### To modify the template

Run the server

```shell
middleman s
```

An example changelog with dummy data can be found at `source/index.html`. You can see it in your browser at `http://localhost:4567`.

The template without dummy data is located in `source/template.html`. If you update the `source/index.html` file, be sure to copy your changes (without the dummy data) into `source/template.html`.

### To update the font icons

The font icons are generated by [Icomoon](http://icomoon.io) and then imported into the project by the rake task at `lib/tasks/import_icons.rake`

To change the icons, visit Icomoon, build an icon set and download the file. It will be packaged as a `.zip` file. Make note of the file name, usually something like `icons.zip` or `icons (2).zip`

Leave the `.zip` file in your `~/Downloads` folder then run the import task:

```shell
rake icons:update["icons (2).zip"]
```

In `zsh` you may have to escape the `[]` characters:

```shell
rake icons:update\["icons (4).zip"\]
```

This will extract the `.zip` file, copy the font files into the template's `souce/fonts` folder, and update the stylesheet at `source/stylesheets/components/_icons.css.sass`.
